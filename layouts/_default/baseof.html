<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "en" }}" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
    <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta name="author" content="{{ .Site.Params.author }}">
    <link rel="canonical" href="{{ .Permalink }}">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">

    <!-- Performance hints -->
    {{ partial "performance-hints.html" . }}

    <!-- Open Graph (Facebook) & Twitter Cards - Hugo Built-in Templates -->
    {{ partial "opengraph.html" . }}
    {{ partial "twitter_cards.html" . }}

    <!-- RSS Feed -->
    {{ with .OutputFormats.Get "rss" }}
      <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink }}" title="{{ $.Site.Title }}">
    {{ end }}

    <!-- CSS with enhanced resource processing -->
    {{ partial "head-resources.html" . }}

    <!-- Preload critical fonts -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"></noscript>

    <!-- Google Analytics - Hugo Built-in Template -->
    {{ partial "google_analytics.html" . }}
</head>
<body class="bg-gray-50 text-gray-900 font-sans antialiased">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary text-white px-4 py-2 rounded-lg z-50">
        {{ i18n "skip_to_main" }}
    </a>

    <div class="min-h-screen flex">
        <!-- Sidebar -->
        {{ partialCached "sidebar.html" . .Language.Lang }}

        <!-- Floating Controls (Language & Theme Switchers) -->
        {{ partialCached "floating-controls.html" . .Language.Lang }}

        <!-- Main Content -->
        <main id="main-content" class="flex-1 min-h-screen bg-gray-50 transition-all duration-300">
            <!-- Reading progress indicator for blog posts -->
            {{ partial "reading-progress.html" . }}

            <!-- Breadcrumbs for navigation and SEO -->
            {{ if not .IsHome }}
                {{ partial "breadcrumbs.html" . }}
            {{ end }}

            {{ block "main" . }}{{ end }}
        </main>
    </div>

    <!-- Optimized JavaScript bundle -->
    {{ partial "scripts-bundle.html" . }}

    <!-- Custom scripts -->
    {{ block "scripts" . }}{{ end }}
</body>
</html>
