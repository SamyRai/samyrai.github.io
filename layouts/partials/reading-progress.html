{{- /*
  Reading progress indicator for blog posts
  Only shown on single post pages
*/ -}}

{{- if and (eq .Type "posts") (not .IsHome) -}}
<div id="reading-progress" class="reading-progress" role="progressbar" aria-label="Reading progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
  <div class="reading-progress-bar"></div>
</div>

<script>
  (function() {
    const progressBar = document.querySelector('.reading-progress-bar');
    const progressContainer = document.getElementById('reading-progress');

    if (!progressBar || !progressContainer) return;

    function updateProgress() {
      const windowHeight = window.innerHeight;
      const documentHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const trackLength = documentHeight - windowHeight;
      const percentage = Math.min((scrollTop / trackLength) * 100, 100);

      progressBar.style.width = percentage + '%';
      progressContainer.setAttribute('aria-valuenow', Math.round(percentage));
    }

    window.addEventListener('scroll', updateProgress, { passive: true });
    window.addEventListener('resize', updateProgress, { passive: true });
    updateProgress();
  })();
</script>
{{- end -}}
